
<!DOCTYPE html>
<html lang="en">
    <head><meta name="generator" content="Hexo 3.8.0">
        <title>Introduction — Infection PHP</title>
        <meta charset="utf-8">
        <meta name="description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <meta property="og:type" content="article">
        <meta property="og:title" content="Introduction — Infection PHP">
        <meta property="og:description" content="Infection - PHP Mutation Testing Framework.">
        <meta property="og:image" content="https://infection.github.io//images/logo.png">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Introduction — Infection PHP">
        <meta name="twitter:description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="twitter:image" content="https://infection.github.io/images/logo.png">

        <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="192x192" href="/images/icons/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
        <link rel="icon" href="/images/logo.png" type="image/png">

        <meta name="msapplication-TileColor" content="#4fc08d">
        <meta name="theme-color" content="#4fc08d">

        <meta name="msapplication-config" content="browserconfig.xml">
        <link rel="manifest" href="/manifest.json">

        <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Dosis:500&text=Infection PHP" rel="stylesheet" type="text/css">

        <!-- main page styles -->
        <link rel="stylesheet" href="/css/page.css">

        <!-- this needs to be loaded before guide's inline scripts -->
        <script src="/js/vue.js"></script>
        <script>window.PAGE_TYPE = "guide"</script>
    </head>
    <body class="docs">        <div id="mobile-bar">
            <a class="menu-button"></a>
            <a class="logo" href="/"></a>
        </div>
        <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.png">
    <span>Infection</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    
    <div class="sidebar">
    <ul class="main-menu">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

    </ul>
    <div class="list">
        <ul class="menu-root">
    
        
        
            
                <li><h3>Documentation</h3></li>
            
            
        
        
        <li>
            <a href="/guide/index.html" class="sidebar-link current">Introduction</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/usage.html" class="sidebar-link">Usage</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/command-line-options.html" class="sidebar-link">Command Line Options</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/mutators.html" class="sidebar-link">Mutators</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/custom-mutators.html" class="sidebar-link new">Custom Mutators</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/profiles.html" class="sidebar-link">Profiles</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/using-with-ci.html" class="sidebar-link">Using with CI</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/mutation-badge.html" class="sidebar-link">Mutation Badge, cloud HTML report</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/how-to.html" class="sidebar-link">How-to Guides</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/caveats.html" class="sidebar-link">Caveats</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/debugging-issues.html" class="sidebar-link">Debugging Issues</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/infection-playground.html" class="sidebar-link">Infection Playground</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/github-sponsors.html" class="sidebar-link">GitHub Sponsors ♥️</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/supported-test-frameworks.html" class="sidebar-link">Supported Test Frameworks</a>
        </li>
    
        
        
            
            
                <li><h3>Miscellaneous</h3></li>
            
        
        
        <li>
            <a href="/guide/compare.html" class="sidebar-link">Compare with competitors</a>
        </li>
    
    <li><h3>Posts</h3></li>
    
        <li>
            <a href="/2022/01/10/whats-new-in-0.26.0/" class="sidebar-link">What's new in Infection 0.26.0</a>
        </li>
    
        <li>
            <a href="/2021/09/06/whats-new-in-0.25.0/" class="sidebar-link">What's new in Infection 0.25.0</a>
        </li>
    
        <li>
            <a href="/2021/07/27/whats-new-in-0.24.0/" class="sidebar-link">What's new in Infection 0.24.0</a>
        </li>
    
        <li>
            <a href="/2021/05/13/whats-new-in-0.23.0/" class="sidebar-link">What's new in Infection 0.23.0</a>
        </li>
    
        <li>
            <a href="/2021/01/27/whats-new-in-0.21.0/" class="sidebar-link">What's new in Infection 0.21.0</a>
        </li>
    
    
</ul>

    </div>
</div>


<div class="content guide with-sidebar index-guide">
    
      
    
    
      <h1>Introduction</h1>
    
    <h2 id="What-is-Mutation-Testing"><a href="#What-is-Mutation-Testing" class="headerlink" title="What is Mutation Testing?"></a>What is Mutation Testing?</h2><p>Mutation Testing is a fault-based testing technique which provides a testing criterion called the <em>Mutation Score Indicator (MSI)</em>. The MSI can be used to measure the effectiveness of a test set in terms of its ability to detect faults.</p>
<p>Mutation testing involves modifying a program in small ways. Each mutated version is called a <strong>Mutant</strong>. To assess the quality of a given test set, these mutants are executed against the input test set to see if the seeded faults can be detected. If mutated program produces failing tests, this is called a <em>killed mutant</em>. If tests are green with mutated code, then we have an <em>escaped</em> mutant. </p>
<p>Test suites are measured by the percentage of mutants that they kill. New tests can be designed to kill additional mutants.</p>
<p>Mutants are based on well-defined <strong>Mutators</strong> (<a href="./mutators.html">mutation operators</a>) that either mimic typical programming errors (such as using the wrong operator or variable name) or force the creation of valuable tests (such as dividing each expression by zero)</p>
<blockquote>
<p>Read more about Mutation Testing in <a href="https://web.archive.org/web/20210625032118/http://crestweb.cs.ucl.ac.uk/resources/mutation_testing_repository/" target="_blank" rel="noopener">Mutation Testing Repository</a></p>
</blockquote>
<h2 id="What-is-Infection"><a href="#What-is-Infection" class="headerlink" title="What is Infection?"></a>What is Infection?</h2><p>Infection is a <strong>PHP mutation testing library</strong> based on AST (Abstract Syntax Tree) mutations. It works as a CLI tool and can be executed from your project’s root. </p>
<blockquote>
<p>Read a <a href="https://medium.com/@maks_rafalko/infection-mutation-testing-framework-c9ccf02eefd1" target="_blank" rel="noopener">detailed post</a> about Mutation Testing and Infection on Medium</p>
</blockquote>
<p>Infection currently supports <code>PHPUnit</code>, <code>PhpSpec</code> and <code>Codeception</code> test frameworks, requires PHP 7.4+ and Xdebug/phpdbg/pcov installed.</p>
<p>In a nutshell, it </p>
<ul>
<li>runs the test suite to see if all tests pass</li>
<li>mutates the source code with a set of predefined mutators (mutation operators)</li>
<li>for each Mutant (modified code with one change) it runs the tests that cover changed line</li>
<li>analyzes whether the tests start to fail</li>
<li>collects the results of killed, escaped Mutants, errors and timeouts</li>
</ul>
<p>Given you have a <code>Form</code> class with <code>hasErrors()</code> method,</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Form.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hasErrors</span><span class="params">()</span>: <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> count(<span class="keyword">$this</span>-&gt;errors) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Infection will create the following mutants:</p>
<p>Conditional boundary mutator:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">public function hasErrors(): bool</span><br><span class="line">&#123;</span><br><span class="line"><span class="deletion">-    return count($this-&gt;errors) &gt; 0;</span></span><br><span class="line"><span class="addition">+    return count($this-&gt;errors) &gt;= 0;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Conditional negotiation mutator:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">public function hasErrors(): bool</span><br><span class="line">&#123;</span><br><span class="line"><span class="deletion">-    return count($this-&gt;errors) &gt; 0;</span></span><br><span class="line"><span class="addition">+    return count($this-&gt;errors) &lt; 0;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Integer 0-1, 1-0 mutator:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">public function hasErrors(): bool</span><br><span class="line">&#123;</span><br><span class="line"><span class="deletion">-    return count($this-&gt;errors) &gt; 0;</span></span><br><span class="line"><span class="addition">+    return count($this-&gt;errors) &gt; 1;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>and so on.</p>
<h2 id="Metrics-Mutation-Score-Indicator-MSI"><a href="#Metrics-Mutation-Score-Indicator-MSI" class="headerlink" title="Metrics. Mutation Score Indicator (MSI)"></a>Metrics. Mutation Score Indicator (MSI)</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Metrics:</span><br><span class="line">    Mutation Score Indicator (MSI): 47%</span><br><span class="line">    Mutation Code Coverage: 67%</span><br><span class="line">    Covered Code MSI: 70%</span><br></pre></td></tr></table></figure>
<p>This example results reported a number of metric scores:</p>
<h3 id="Mutation-Score-Indicator-MSI"><a href="#Mutation-Score-Indicator-MSI" class="headerlink" title="Mutation Score Indicator (MSI)"></a>Mutation Score Indicator (MSI)</h3><p>MSI is 47%. This means that 47% of all generated mutations were detected (i.e. kills, timeouts or fatal errors). The MSI is the primary Mutation Testing metric. Given the code coverage of 67%, there is a 20% difference so Code Coverage was a terrible quality measurement in this example.</p>
<p>Calculation formula:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TotalDefeatedMutants = KilledCount + TimedOutCount + ErrorCount;</span><br><span class="line"></span><br><span class="line">MSI = (TotalDefeatedMutants / TotalMutantsCount) * 100;</span><br></pre></td></tr></table></figure>
<h3 id="Mutation-Code-Coverage"><a href="#Mutation-Code-Coverage" class="headerlink" title="Mutation Code Coverage"></a>Mutation Code Coverage</h3><p>MCC is 67%. On average it should be within the same ballpark as your normal code coverage.</p>
<p>Calculation formula:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TotalCoveredByTestsMutants = TotalMutantsCount - NotCoveredByTestsCount;</span><br><span class="line"></span><br><span class="line">CoveredRate = (TotalCoveredByTestsMutants / TotalMutantsCount) * 100;</span><br></pre></td></tr></table></figure>
<h3 id="Covered-Code-Mutation-Score-Indicator"><a href="#Covered-Code-Mutation-Score-Indicator" class="headerlink" title="Covered Code Mutation Score Indicator"></a>Covered Code Mutation Score Indicator</h3><p>MSI for code <em>that is actually covered by tests</em> was 70% (ignoring not tested code). This shows you how effective the tests really are.</p>
<p>Calculation formula:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">TotalCoveredByTestsMutants = TotalMutantsCount - NotCoveredByTestsCount;</span><br><span class="line">TotalDefeatedMutants = KilledCount + TimedOutCount + ErrorCount;</span><br><span class="line"></span><br><span class="line">CoveredCodeMSI = (TotalDefeatedMutants / TotalCoveredByTestsMutants) * 100;</span><br></pre></td></tr></table></figure>
<p>If you examine these metrics, the standout issue is that the MSI of 47% is 18 points lower than the reported Code Coverage at 65%. These unit tests are far less effective than Code Coverage alone could detect.</p>
<p>Interpreting these results requires some context. The logs will list all undetected mutations as diffs against the original source code. Examining these will provide further insight as to what specific mutations went undetected.</p>
<h2 id="Ready-for-More"><a href="#Ready-for-More" class="headerlink" title="Ready for More?"></a>Ready for More?</h2><p>We’ve just briefly introduced the basic information about Mutation Testing and Infection itself - the rest of this guide will cover other advanced features with much details, so make sure to read through it all!</p>
<p>Want to try Infection right now? Use our <a href="https://infection-php.dev/" target="_blank" rel="noopener">Playground</a>.</p>

    
      <div class="guide-links">
        
        
      </div>
    
    <div class="footer">
      Caught a mistake or want to contribute to the documentation?
      <a href="https://github.com/infection/site/blob/master/src/guide/index.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

                
            </div>
            <script src="/js/smooth-scroll.min.js"></script>
        

        <!-- main custom script for sidebars, version selects etc. -->
        <script src="/js/css.escape.js"></script>
        <script src="/js/common.js"></script>
        <script src="/js/theme-switch.js"></script>

        <!-- search -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
        <link rel="stylesheet" href="/css/search.css">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
        <script>
        [
          '#search-query-nav',
          '#search-query-sidebar',
          '#search-query-menu'
        ].forEach(function (selector) {
          if (!document.querySelector(selector)) return
          docsearch({
              apiKey: '75081c711113ff76f9ed83bf001741a1',
              indexName: 'infection',
              inputSelector: selector,
              debug: false // Set debug to true if you want to inspect the dropdown
          });
        })
        </script>

        <!-- fastclick -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          FastClick.attach(document.body)
        }, false)
        </script>
    </body>
</html>
