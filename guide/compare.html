
<!DOCTYPE html>
<html lang="en">
    <head><meta name="generator" content="Hexo 3.8.0">
        <title>Compare with competitors — Infection PHP</title>
        <meta charset="utf-8">
        <meta name="description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <meta property="og:type" content="article">
        <meta property="og:title" content="Compare with competitors — Infection PHP">
        <meta property="og:description" content="Infection - PHP Mutation Testing Framework.">
        <meta property="og:image" content="https://infection.github.io//images/logo.png">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Compare with competitors — Infection PHP">
        <meta name="twitter:description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="twitter:image" content="https://infection.github.io/images/logo.png">

        <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="192x192" href="/images/icons/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
        <link rel="icon" href="/images/logo.png" type="image/png">

        <meta name="msapplication-TileColor" content="#4fc08d">
        <meta name="theme-color" content="#4fc08d">

        <meta name="msapplication-config" content="browserconfig.xml">
        <link rel="manifest" href="/manifest.json">

        <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Dosis:500&text=Infection PHP" rel="stylesheet" type="text/css">

        <!-- main page styles -->
        <link rel="stylesheet" href="/css/page.css">

        <!-- this needs to be loaded before guide's inline scripts -->
        <script src="/js/vue.js"></script>
        <script>window.PAGE_TYPE = "guide"</script>
    </head>
    <body class="docs">        <div id="mobile-bar">
            <a class="menu-button"></a>
            <a class="logo" href="/"></a>
        </div>
        <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.png">
    <span>Infection</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    
    <div class="sidebar">
    <ul class="main-menu">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-sidebar" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link current">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

    </ul>
    <div class="list">
        <ul class="menu-root">
    
        
        
            
                <li><h3>Documentation</h3></li>
            
            
        
        
        <li>
            <a href="/guide/index.html" class="sidebar-link">Introduction</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/installation.html" class="sidebar-link">Installation</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/usage.html" class="sidebar-link">Usage</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/command-line-options.html" class="sidebar-link">Command Line Options</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/mutators.html" class="sidebar-link">Mutators</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/custom-mutators.html" class="sidebar-link new">Custom Mutators</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/profiles.html" class="sidebar-link">Profiles</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/using-with-ci.html" class="sidebar-link">Using with CI</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/mutation-badge.html" class="sidebar-link">Mutation Badge, cloud HTML report</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/how-to.html" class="sidebar-link">How-to Guides</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/caveats.html" class="sidebar-link">Caveats</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/debugging-issues.html" class="sidebar-link">Debugging Issues</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/infection-playground.html" class="sidebar-link">Infection Playground</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/github-sponsors.html" class="sidebar-link">GitHub Sponsors ♥️</a>
        </li>
    
        
        
            
            
        
        
        <li>
            <a href="/guide/supported-test-frameworks.html" class="sidebar-link">Supported Test Frameworks</a>
        </li>
    
        
        
            
            
                <li><h3>Miscellaneous</h3></li>
            
        
        
        <li>
            <a href="/guide/compare.html" class="sidebar-link current">Compare with competitors</a>
        </li>
    
    <li><h3>Posts</h3></li>
    
        <li>
            <a href="/2022/01/10/whats-new-in-0.26.0/" class="sidebar-link">What's new in Infection 0.26.0</a>
        </li>
    
        <li>
            <a href="/2021/09/06/whats-new-in-0.25.0/" class="sidebar-link">What's new in Infection 0.25.0</a>
        </li>
    
        <li>
            <a href="/2021/07/27/whats-new-in-0.24.0/" class="sidebar-link">What's new in Infection 0.24.0</a>
        </li>
    
        <li>
            <a href="/2021/05/13/whats-new-in-0.23.0/" class="sidebar-link">What's new in Infection 0.23.0</a>
        </li>
    
        <li>
            <a href="/2021/01/27/whats-new-in-0.21.0/" class="sidebar-link">What's new in Infection 0.21.0</a>
        </li>
    
    
</ul>

    </div>
</div>


<div class="content guide with-sidebar compare-guide">
    
      
    
    
      <h1>Compare with competitors</h1>
    
    <p>What is the difference between Infection and other PHP mutation testing libraries?</p>
<p>Well, there is only one competitor at the moment - Humbug.<br>Sidenote: Humbug is discontinued and refers its user to Infection.</p>
<h2 id="Technical-differences"><a href="#Technical-differences" class="headerlink" title="Technical differences"></a>Technical differences</h2><h3 id="Mutations"><a href="#Mutations" class="headerlink" title="Mutations"></a>Mutations</h3><p>The main and the best difference is that Infection uses AST (Abstract Syntax Tree) to mutate the code. It brings so much value to the library:</p>
<ul>
<li>Much easier to support code</li>
<li>Much easier to write new Mutators</li>
<li>Much easier to handle false-positives and different edge cases, e.g. deciding when mutation should be done or should not in difficult situation</li>
</ul>
<p>Let’s look at the following examples to understand how AST helps here. This is an implementation of mutator in Infection:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://github.com/infection/infection/blob/master/src/Mutator/Arithmetic/Plus.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Plus</span> <span class="keyword">implements</span> <span class="title">Mutator</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Replaces "+" with "-"</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Node $node</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Node\Expr\BinaryOp\Minus</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">mutate</span><span class="params">(Node $node)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Node\Expr\BinaryOp\Minus($node-&gt;left, $node-&gt;right, $node-&gt;getAttributes());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">shouldMutate</span><span class="params">(Node $node)</span> : <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!($node <span class="keyword">instanceof</span> Node\Expr\BinaryOp\Plus)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($node-&gt;left <span class="keyword">instanceof</span> Array_ &amp;&amp; $node-&gt;right <span class="keyword">instanceof</span> Array_) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The code is very clear. The class is small. Here we are working with objects that represent nodes of our code in an Object Oriented way.</p>
<p>Let’s look at the Humbug’s implementation of the same mutator that replaces <code>+</code> with <code>-</code>.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Addition</span> <span class="keyword">extends</span> <span class="title">MutatorAbstract</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getMutation</span><span class="params">(array &amp;$tokens, $index)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $tokens[$index] = <span class="string">'-'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">mutates</span><span class="params">(array &amp;$tokens, $index)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $t = $tokens[$index];</span><br><span class="line">        <span class="keyword">if</span> (!is_array($t) &amp;&amp; $t == <span class="string">'+'</span>) &#123;</span><br><span class="line">            $tokenCount = count($tokens);</span><br><span class="line">            <span class="keyword">for</span> ($i = $index + <span class="number">1</span>; $i &lt; $tokenCount; $i++) &#123;</span><br><span class="line">                <span class="comment">// check for short array syntax</span></span><br><span class="line">                <span class="keyword">if</span> (!is_array($tokens[$i]) &amp;&amp; $tokens[$i][<span class="number">0</span>] == <span class="string">'['</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// check for long array syntax</span></span><br><span class="line">                <span class="keyword">if</span> (is_array($tokens[$i]) &amp;&amp; $tokens[$i][<span class="number">0</span>] == T_ARRAY &amp;&amp; $tokens[$i][<span class="number">1</span>] == <span class="string">'array'</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// if we're at the end of the array</span></span><br><span class="line">                <span class="comment">// and we didn't see any array, we</span></span><br><span class="line">                <span class="comment">// can probably mutate this addition</span></span><br><span class="line">                <span class="keyword">if</span> (!is_array($tokens[$i]) &amp;&amp; $tokens[$i] == <span class="string">';'</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Do you see the difference? Just imagine how difficult to understand and support such code. </p>
<blockquote>
<p>I don’t say that Humbug’s code is bad, no. Here I just want to show you that using AST brings so much value and simplifies the code a lot.</p>
</blockquote>
<p>If you still don’t believe that AST is a thing, just compare these two mutators that replace <code>return functionCall();</code> with <code>functionCall(); return null;</code>:</p>
<ul>
<li>Humbug: <a href="https://github.com/humbug/humbug/blob/1.0.0-alpha2/src/Mutator/ReturnValue/FunctionCall.php" target="_blank" rel="noopener">https://github.com/humbug/humbug/blob/1.0.0-alpha2/src/Mutator/ReturnValue/FunctionCall.php</a></li>
<li>Infection: <a href="https://github.com/infection/infection/blob/0.2.1/src/Mutator/ReturnValue/FunctionCall.php" target="_blank" rel="noopener">https://github.com/infection/infection/blob/0.2.1/src/Mutator/ReturnValue/FunctionCall.php</a></li>
</ul>
<p>Excited?</p>
<h3 id="Dependencies-in-composer-json"><a href="#Dependencies-in-composer-json" class="headerlink" title="Dependencies in composer.json"></a>Dependencies in <code>composer.json</code></h3><p>I spent much time understanding how we can get rid of PHPUnit and PhpSpec dependencies for production build of Infection.</p>
<p>In order to run particular (not all) tests from the suite for each Mutation, Humbug subscribes to the PHPUnit process with its own listener and filters out not needed tests. So it has a listener that extends PHPUnit’s <code>\PHPUnit_Framework_BaseTestListener</code> class. This couples Humbug with PHPUnit, even with particular version(s).</p>
<p>Obviously, if the code you are mutating uses a different (incompatible) version of PHPUnit, you can not use Humbug in this case.</p>
<h4 id="How-did-we-solve-this-issue-in-Infection"><a href="#How-did-we-solve-this-issue-in-Infection" class="headerlink" title="How did we solve this issue in Infection?"></a>How did we solve this issue in Infection?</h4><p>Ok, the answer is <code>XML</code> reports. PHPUnit generates the same (almost ;)) <code>XML</code> for running test suite where we can find information about executed lines of code, time of each test case, the original path to the tested file and so on. Moreover, PHPUnit allows adding a set of test files that need to be ran in its <code>phpunit.xml</code> file.</p>
<p>So, instead of filtering tests in runtime, Infection just adds correct files to custom <code>phpunit.xml</code> and runs the test suite with it. That’s it.</p>
<h3 id="Developer-experience-DX"><a href="#Developer-experience-DX" class="headerlink" title="Developer experience (DX)"></a>Developer experience (DX)</h3><p>One of the best initiatives in the PHP community is a Developer Experience improvements.</p>
<p>Let’s have an example of <code>configure</code> command of Infection. The typical mutation library works like:</p>
<ul>
<li>you run mutation tool</li>
<li>it does not find a config file and fails with an error message</li>
<li>you run <code>configure</code> command (or something similar) and create this config</li>
<li>you run mutation tool again</li>
</ul>
<p>So many annoying steps.</p>
<p>Thanks to Symfony’s Console component, it’s possible to run commands from another command. And this is exactly what we need. Let’s look how the process looks like in Infection:</p>
<ul>
<li>you run <code>infection</code> for the first time</li>
<li>and it does not find any of <code>infection.json5</code> / <code>infection.json</code> / <code>infection.json5.dist</code> / <code>infection.json.dist</code></li>
<li>it automatically runs <code>infection configure</code> command without interrupting the main process</li>
<li>it asks you some questions and <em>tries to guess</em> all possible values for you</li>
<li>after configuration is done, it just continues with the initial command</li>
</ul>
<p>So you run <code>infection</code> only once.</p>
<h4 id="Set-of-Guessers-from-configure-command"><a href="#Set-of-Guessers-from-configure-command" class="headerlink" title="Set of Guessers from configure command"></a>Set of Guessers from <code>configure</code> command</h4><h5 id="PHPUnit-Config-Path-Guesser"><a href="#PHPUnit-Config-Path-Guesser" class="headerlink" title="PHPUnit Config Path Guesser"></a>PHPUnit Config Path Guesser</h5><p>Do you remember old versions of Symfony where <code>phpunit.xml.dist</code> was located in <code>./app</code> folder?</p>
<p>Infection’s <code>PhpUnitPathGuesser</code> parses your <code>composer.json</code> file and automatically suggests custom path where PHPUnit’s config file is found.</p>
<h5 id="Source-dirs-Guesser"><a href="#Source-dirs-Guesser" class="headerlink" title="Source dirs Guesser"></a>Source dirs Guesser</h5><p>Thanks to <code>PSR-0</code> and <code>PSR-4</code>, you can configure your source folders in <code>composer.json</code>:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"autoload"</span>: &#123;</span><br><span class="line">        <span class="attr">"psr-4"</span>: &#123;</span><br><span class="line">            <span class="attr">"Infection\\"</span>: <span class="string">"src/"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>SourceDirGuesser</code> automatically parses your <code>composer.json</code> file and suggests all source folders for you (as a default value or by autocompletion feature of Symfony Console component).</p>
<p>There are several other guessers but I believe you see the point.</p>

    
      <div class="guide-links">
        
        
      </div>
    
    <div class="footer">
      Caught a mistake or want to contribute to the documentation?
      <a href="https://github.com/infection/site/blob/master/src/guide/compare.md" target="_blank">
        Edit this page on Github!
      </a>
    </div>
</div>

                
            </div>
            <script src="/js/smooth-scroll.min.js"></script>
        

        <!-- main custom script for sidebars, version selects etc. -->
        <script src="/js/css.escape.js"></script>
        <script src="/js/common.js"></script>
        <script src="/js/theme-switch.js"></script>

        <!-- search -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
        <link rel="stylesheet" href="/css/search.css">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
        <script>
        [
          '#search-query-nav',
          '#search-query-sidebar',
          '#search-query-menu'
        ].forEach(function (selector) {
          if (!document.querySelector(selector)) return
          docsearch({
              apiKey: '75081c711113ff76f9ed83bf001741a1',
              indexName: 'infection',
              inputSelector: selector,
              debug: false // Set debug to true if you want to inspect the dropdown
          });
        })
        </script>

        <!-- fastclick -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          FastClick.attach(document.body)
        }, false)
        </script>
    </body>
</html>
