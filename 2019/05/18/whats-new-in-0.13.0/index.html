
<!DOCTYPE html>
<html lang="en">
    <head><meta name="generator" content="Hexo 3.8.0">
        <title>What's new in Infection 0.13.0 — Infection PHP</title>
        <meta charset="utf-8">
        <meta name="description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

        <meta property="og:type" content="article">
        <meta property="og:title" content="What's new in Infection 0.13.0 — Infection PHP">
        <meta property="og:description" content="Infection - PHP Mutation Testing Framework.">
        <meta property="og:image" content="https://infection.github.io//images/logo.png">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="What's new in Infection 0.13.0 — Infection PHP">
        <meta name="twitter:description" content="Infection - PHP Mutation Testing Framework.">
        <meta name="twitter:image" content="https://infection.github.io/images/logo.png">

        <link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="192x192" href="/images/icons/android-icon-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
        <link rel="icon" href="/images/logo.png" type="image/png">

        <meta name="msapplication-TileColor" content="#4fc08d">
        <meta name="theme-color" content="#4fc08d">

        <meta name="msapplication-config" content="browserconfig.xml">
        <link rel="manifest" href="/manifest.json">

        <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600|Roboto Mono" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Dosis:500&text=Infection PHP" rel="stylesheet" type="text/css">

        <!-- main page styles -->
        <link rel="stylesheet" href="/css/page.css">

        <!-- this needs to be loaded before guide's inline scripts -->
        <script src="/js/vue.js"></script>
        <script>window.PAGE_TYPE = "{{type}}"</script>
    </head>
    <body class="docs">        <div id="mobile-bar">
            <a class="menu-button"></a>
            <a class="logo" href="/"></a>
        </div>
        <div id="header">
  <a id="logo" href="/">
    <img src="/images/logo.png">
    <span>Infection</span>
  </a>
  <ul id="nav">
    <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

  </ul>
</div>

        
            <div id="main" class="fix-sidebar">
                
                    <div class="sidebar blog">
    <ul class="main-menu">
        <li>
  <form id="search-form">
    <input type="text" id="search-query-nav" class="search-query st-default-search-input">
  </form>
</li>
<li><a href="/guide/" class="nav-link">Guide</a></li>
<li><a href="https://infection-php.dev/" target="_blank">Playground</a></li>
<li><a href="https://github.com/infection/infection" target="_blank">GitHub</a></li>
<li class="nav-dropdown-container ecosystem">
  <a class="nav-link">Ecosystem</a><span class="arrow"></span>
  <ul class="nav-dropdown">
    <li><h4>Help</h4></li>
    <li><ul>
      <li><a href="https://twitter.com/infection_php" class="nav-link" target="_blank">Twitter</a></li>
      <li><a href="https://mastodon.social/@infection_php" class="nav-link" target="_blank">Mastodon </a></li>
      <li><a href="https://discord.gg/ZUmyHTJ" class="nav-link" target="_blank">Discord </a></li>
      <li><a href="https://github.com/infection/infection/discussions" class="nav-link" target="_blank">Infection Discussions </a></li>
    </ul></li>
    <li><h4>Resource Lists</h4></li>
    <li><ul>
      <li><a href="https://github.com/infection" class="nav-link" target="_blank">Official Repos</a></li>
    </ul></li>
  </ul>
</li>



<li>
    <a id="theme-toggle" style="cursor: pointer;">
        <i id="theme-toggle-icon" class="theme-icon"></i>
    </a>
</li>

    </ul>
    <div class="list">
        <h2>
            Recent Posts
            <a href="/atom.xml" target="_blank" style="vertical-align: middle; margin-left: 5px">
                <img src="/images/feed.png" style="width:15px;height:15px">
            </a>
        </h2>
        <ul style="padding:0">
        
            <li>
                <a href="/2022/01/10/whats-new-in-0.26.0/" class="sidebar-link">What's new in Infection 0.26.0</a>
            </li>
        
            <li>
                <a href="/2021/09/06/whats-new-in-0.25.0/" class="sidebar-link">What's new in Infection 0.25.0</a>
            </li>
        
            <li>
                <a href="/2021/07/27/whats-new-in-0.24.0/" class="sidebar-link">What's new in Infection 0.24.0</a>
            </li>
        
            <li>
                <a href="/2021/05/13/whats-new-in-0.23.0/" class="sidebar-link">What's new in Infection 0.23.0</a>
            </li>
        
            <li>
                <a href="/2021/01/27/whats-new-in-0.21.0/" class="sidebar-link">What's new in Infection 0.21.0</a>
            </li>
        
            <li>
                <a href="/2020/11/01/whats-new-in-0.20.0/" class="sidebar-link">What's new in Infection 0.20.0</a>
            </li>
        
            <li>
                <a href="/2020/10/28/whats-new-in-0.19.0/" class="sidebar-link">What's new in Infection 0.19.0</a>
            </li>
        
            <li>
                <a href="/2020/10/17/whats-new-in-0.18.0/" class="sidebar-link">What's new in Infection 0.18.0</a>
            </li>
        
            <li>
                <a href="/2020/08/18/whats-new-in-0.17.0/" class="sidebar-link">What's new in Infection 0.17.0</a>
            </li>
        
            <li>
                <a href="/2020/03/28/whats-new-in-0.16.0/" class="sidebar-link">What's new in Infection 0.16.0</a>
            </li>
        
        </ul>
    </div>
</div>
<div class="content with-sidebar blog post">
    <h1>What's new in Infection 0.13.0</h1>
    <h4>May 18, 2019</h4>
    <p>Release: <a href="https://github.com/infection/infection/releases/tag/0.13.0" target="_blank" rel="noopener">https://github.com/infection/infection/releases/tag/0.13.0</a></p>
<h2 id="New-features-and-enhancements"><a href="#New-features-and-enhancements" class="headerlink" title="New features and enhancements"></a>New features and enhancements</h2><h3 id="Proper-array-coverage"><a href="#Proper-array-coverage" class="headerlink" title="Proper array coverage"></a>Proper array coverage</h3><p>As shown on the image below, array coverage is a bit wonky in PHP, and not all items are considered covered.</p>
<p><img src="/images/posts/0-13-0/array_coverage.png" alt="array coverage"></p>
<p>Before <code>0.13.0</code>, mutants, created from not covered lines could not be killed.</p>
<p>Now, even with such coverage results, Infection will treat those white lines as covered so you can kill generated Mutants.</p>
<h3 id="pcov-support"><a href="#pcov-support" class="headerlink" title="pcov support"></a><code>pcov</code> support</h3><p>We’ve added a preliminary support for <a href="https://github.com/krakjoe/pcov" target="_blank" rel="noopener"><code>pcov</code></a> - quite new CodeCoverage compatible driver for PHP.</p>
<ul>
<li><a href="https://github.com/krakjoe/pcov" target="_blank" rel="noopener">https://github.com/krakjoe/pcov</a></li>
</ul>
<h3 id="Ignore-mutator-on-particular-line-of-the-code"><a href="#Ignore-mutator-on-particular-line-of-the-code" class="headerlink" title="Ignore mutator on particular line of the code"></a>Ignore mutator on particular line of the code</h3><p>It was possible to disable (ignore) mutators for <a href="/guide/how-to.html#Disable-in-particular-class-or-method">classes and methods using wildcards</a>.</p>
<p>Now it’s also possible to disable mutators just for one line of the code:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"mutators"</span>: &#123;</span><br><span class="line">        <span class="attr">"MethodCallRemoval"</span>: &#123;</span><br><span class="line">            <span class="attr">"ignore"</span>: [</span><br><span class="line">                <span class="string">"Infection\\Finder\\SourceFilesFinder::__construct::63"</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="no-progress-option-automatically-enabled-on-CI-server"><a href="#no-progress-option-automatically-enabled-on-CI-server" class="headerlink" title="--no-progress option (automatically enabled on CI server)"></a><code>--no-progress</code> option (automatically enabled on CI server)</h3><p>The amount of text generated by the initial processes (running tests, generating mutations) is quite big, specially when running it on medium to large projects. This is basically due to the progress bars that are being used and that, for CI environments without proper ANSI support, is quite irrelevant.</p>
<p>It’s better to show it with the screenshot:</p>
<p><img src="/images/posts/0-13-0/output_1.png" alt="before"></p>
<p>Now Infection does not output this information if <code>--no-progress</code> option is used <strong>or</strong> if CI is automatically detected:</p>
<p><img src="/images/posts/0-13-0/output_2.png" alt="before"></p>
<p>For example, there is no need to add this option on Travis. </p>
<h2 id="New-Mutators"><a href="#New-Mutators" class="headerlink" title="New Mutators"></a>New Mutators</h2><p>Starting from <code>0.13.0</code> Infection supports mutation of functions from 2 PHP extensions:</p>
<ul>
<li><code>ext-bcmath</code></li>
<li><code>ext-mbstring</code></li>
</ul>
<h3 id="bcmath-mutators"><a href="#bcmath-mutators" class="headerlink" title="bcmath mutators"></a><code>bcmath</code> mutators</h3><p>The aim of this set of mutators is to ensure project really needs this extension. If you are working with arbitrary precision arithmetic or with really big <code>int</code> numbers - your tests must know about that.</p>
<p>One of the examples of mutation produced by this mutator is:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- $bigIntInString = bcadd($a, b);</span></span><br><span class="line"><span class="addition">+ $bigIntInString = (string) ($a + $b);</span></span><br></pre></td></tr></table></figure>
<p>Either kill it or don’t use <code>bc*</code> functions - they are used without a real reason.</p>
<blockquote>
<p>See all <code>bcmath</code> mutators on the <a href="/guide/mutators.html#BCMath">corresponded documentation page</a>.</p>
</blockquote>
<h3 id="mbstring-mutators"><a href="#mbstring-mutators" class="headerlink" title="mbstring mutators"></a><code>mbstring</code> mutators</h3><p>It is common to see people use multibyte string functions (like <code>mb_strlen()</code>) instead of their common analogs (like <code>strlen()</code>), while not writing any tests exploiting multibyte functionality.</p>
<p>In this situations mutators as simple as below could be of use:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- if (mb_strlen($str) &lt; 10) &#123;</span></span><br><span class="line"><span class="addition">+ if (strlen($str) &lt; 10) &#123;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>See all <code>mbstring</code> mutators on the <a href="/guide/mutators.html#MBString">corresponded documentation page</a>.</p>
</blockquote>
<h3 id="Array-item-removal-mutator"><a href="#Array-item-removal-mutator" class="headerlink" title="Array item removal mutator"></a>Array item removal mutator</h3><p>Removes an item (or items) from the array, depending on Mutator settings.</p>
<p>Example:</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- $keywords = ['select', 'from', 'where'];</span></span><br><span class="line"><span class="addition">+ $keywords = ['from', 'where'];</span></span><br></pre></td></tr></table></figure>
<p>Configuration options:</p>
<ul>
<li><code>remove: first</code>: defines the way the mutator operates. Could be:<ul>
<li><code>first</code> - remove only first element from each array</li>
<li><code>last</code> - remove only last element from each array</li>
<li><code>all</code> - remove every element one by one from each array resulting in as many mutations as total number of items in arrays.</li>
</ul>
</li>
<li><code>limit: PHP_INT_MAX</code>: when <code>remove = all</code> specifies maximum number of elements that will be removed form array. Only elements at the beginning will be mutated.</li>
</ul>
<blockquote>
<p>For more information, see the <a href="/guide/mutators.html#Removal-Mutators">corresponded documentation page</a></p>
</blockquote>
<h3 id="AssignCoalesce-mutator"><a href="#AssignCoalesce-mutator" class="headerlink" title="AssignCoalesce mutator"></a><code>AssignCoalesce</code> mutator</h3><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- $this-&gt;request-&gt;data['comments']['user_id'] ??= 'value';</span></span><br><span class="line"><span class="addition">+ $this-&gt;request-&gt;data['comments']['user_id'] = 'value';</span></span><br></pre></td></tr></table></figure>
<p>See <a href="https://wiki.php.net/rfc/null_coalesce_equal_operator" target="_blank" rel="noopener">https://wiki.php.net/rfc/null_coalesce_equal_operator</a></p>
<h3 id="unwrap-profile-added-last-mutators"><a href="#unwrap-profile-added-last-mutators" class="headerlink" title="@unwrap profile - added last mutators"></a><code>@unwrap</code> profile - added last mutators</h3><p>We’ve added many new mutators that unwrap the function call</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- $a = array_intersect_assoc(['A', 1, 'C'], ['D']);</span></span><br><span class="line"><span class="addition">+ $a = ['A', 1, 'C'];</span></span><br></pre></td></tr></table></figure>
<p>New functions in <code>0.13.0</code> are:</p>
<ul>
<li><code>array_intersect_assoc</code></li>
<li><code>array_pad</code></li>
<li><code>array_udiff</code></li>
<li><code>array_udiff_uassoc</code></li>
<li><code>array_uintersect</code></li>
<li><code>array_uintersect_assoc</code></li>
<li><code>array_uintersect_uassoc</code></li>
<li><code>lcfirst</code></li>
<li><code>trim</code></li>
<li><code>ucfirst</code></li>
<li><code>ucwords</code></li>
</ul>
<blockquote>
<p>All new ideas are tracked here: <a href="https://github.com/infection/infection/issues/514" target="_blank" rel="noopener">https://github.com/infection/infection/issues/514</a><br>See all existing <code>@unwrap</code> mutators on the <a href="/guide/mutators.html#Unwrap-Function">corresponded documentation page</a>.</p>
</blockquote>
<hr>
<p>There are also many bugfixes in <code>0.13.0</code>, please upgrade!</p>
<hr>
<p>Enjoy!</p>
<p><a class="github-button" href="https://github.com/infection/infection" data-icon="octicon-star" data-show-count="true" aria-label="Star infection/infection on GitHub" target="_blank" rel="noopener">Star</a></p>
<script async defer src="https://buttons.github.io/buttons.js"></script>

</div>

                
            </div>
            <script src="/js/smooth-scroll.min.js"></script>
        

        <!-- main custom script for sidebars, version selects etc. -->
        <script src="/js/css.escape.js"></script>
        <script src="/js/common.js"></script>
        <script src="/js/theme-switch.js"></script>

        <!-- search -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
        <link rel="stylesheet" href="/css/search.css">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
        <script>
        [
          '#search-query-nav',
          '#search-query-sidebar',
          '#search-query-menu'
        ].forEach(function (selector) {
          if (!document.querySelector(selector)) return
          docsearch({
              apiKey: '75081c711113ff76f9ed83bf001741a1',
              indexName: 'infection',
              inputSelector: selector,
              debug: false // Set debug to true if you want to inspect the dropdown
          });
        })
        </script>

        <!-- fastclick -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
        <script>
        document.addEventListener('DOMContentLoaded', function() {
          FastClick.attach(document.body)
        }, false)
        </script>
    </body>
</html>
